---
title: "Instacart Data Interactive Plots"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(tidyverse)
library(viridis)
library(plotly)
library(flexdashboard)
```


This dashboard examines a 2017 dataset from the online grocery service, Instacart. It contains over 3 million online grocery orders from more than 200,000 Instacart users.

```{r importing_data, warning=FALSE}
##Need to read in data because the p8105 datasets package does not work on my computer. 
insta_data = readr::read_csv(file = "./data/instacart.csv.zip")
```

Column {data-width=650}
-----------------------------------------------------------------------

### A. Time of Orders (hour) by Grocery Department
This box plot shows the distribution of the time at which items from the various grocery departments are ordered. 

```{r}
dept_by_hour_box = insta_data %>% 
  select(department, order_hour_of_day) 
  
dept_by_hour_box %>% 
  plot_ly(y = ~order_hour_of_day, color = ~department, type = "box",
          colors = "Set2") %>%
  layout(title = "Time of Orders (hour) by Grocery Department")
```

Column {data-width=350}
-----------------------------------------------------------------------

### B. Count of Fruits and Vegetables Ordered by Day of Week

This line plot shows the count of items ordered from the aisles Fresh Fruits and Fresh Vegetables by day of week. 

```{r}
fruit_veggie_day = insta_data %>%
  select(order_dow, order_hour_of_day, product_name, aisle) %>%
  filter(aisle %in% c("fresh fruits" , "fresh vegetables")) %>%
  mutate(
    order_dow = as.factor(order_dow), 
    order_dow = recode(order_dow, "0" = "Sun", "1" = "Mon", "2" = "Tue", "3" = "Wed", "4" = "Thu", "5" = "Fri", "6" = "Sat")
    ) %>% 
  group_by(order_dow, aisle) %>% 
  summarize(count = n()) 

fruit_veggie_day %>%
  plot_ly(
    x = ~order_dow, y = ~count, type = "scatter", mode = "points",
    color = ~aisle, text = ~count) %>% 
  layout(title = "Count of Fruits and Veggies Ordered by Day")
```

### C.Top 5 Purchased Fruits

This bar chart shows the counts of the 5 most popular fruits purchased in the Instacart dataset. 

```{r}
fruit_aisle_data = insta_data %>% 
  select(aisle, product_name, aisle_id, product_id) %>% 
  filter(aisle == "fresh fruits") %>% 
  group_by(product_name) %>%
  summarize(count = n()) %>%
  arrange(desc(count)) %>% 
  ##over 300 items in the fresh fruit aisle, want to look at top 10 of them (10 was too many, so changing to 5)
  slice(1:5)

fruit_aisle_data %>% 
   plot_ly(x = ~product_name, y = ~count, color = ~product_name, type = "bar") %>%
  layout(title = "Top 5 Ordered Fruits")

```
